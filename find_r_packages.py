packages = """AlgDesign_1.1-7.3.tar.gz,
proto_1.0.0.tar.gz,
findpython_1.0.2.tar.gz,
getopt_1.20.0.tar.gz,
rjson_0.2.15.tar.gz,
argparse_1.0.4.tar.gz,
assertthat_0.2.0.tar.gz,
beeswarm_0.2.3.tar.gz,
plogr_0.1-1.tar.gz,
bindr_0.1.tar.gz,
Rcpp_0.12.12.tar.gz,
bindrcpp_0.2.tar.gz,
bnlearn_4.2.tar.gz,
bitops_1.0-6.tar.gz,
RCurl_1.95-4.8.tar.gz,
caTools_1.17.1.tar.gz,
R.methodsS3_1.7.1.tar.gz,
R.oo_1.21.0.tar.gz,
cgdsr_1.2.6.tar.gz,
cluster_2.0.6.tar.gz,
colorspace_1.3-2.tar.gz,
corrplot_0.77.tar.gz,
crayon_1.3.2.tar.gz,
data.table_1.10.4.tar.gz,
jsonlite_1.5.tar.gz,
mime_0.5.tar.gz,
curl_2.8.1.tar.gz,
openssl_0.9.6.tar.gz,
R6_2.2.2.tar.gz,
httr_1.2.1.tar.gz,
digest_0.6.12.tar.gz,
memoise_1.1.0.tar.gz,
whisker_0.3-2.tar.gz,
rstudioapi_0.6.tar.gz,
git2r_0.19.0.tar.gz,
withr_1.0.2.tar.gz,
devtools_1.13.2.tar.gz,
glue_1.1.1.tar.gz,
magrittr_1.5.tar.gz,
praise_1.0.0.tar.gz,
testthat_1.0.2.tar.gz,
pkgconfig_2.0.1.tar.gz,
rlang_0.1.1.tar.gz,
tibble_1.3.3.tar.gz,
BH_1.62.0-1.tar.gz,
dplyr_0.7.2.tar.gz,
e1071_1.6-8.tar.gz,
TeachingDemos_2.10.tar.gz,
plotrix_3.6-5.tar.gz,
plotmo_3.3.3.tar.gz,
earth_4.5.0.tar.gz,
ellipse_0.3-8.tar.gz,
entropy_1.2.1.tar.gz,
fda_2.4.4.tar.gz,
forcats_0.2.0.tar.gz,
iterators_1.0.8.tar.gz,
foreach_1.4.3.tar.gz,
doMC_1.3.4.tar.gz,
snow_0.4-2.tar.gz,
doSNOW_1.0.14.tar.gz,
gtools_3.5.0.tar.gz,
gdata_2.18.0.tar.gz,
gtable_0.2.0.tar.gz,
plyr_1.8.4.tar.gz,
stringi_1.1.5.tar.gz,
stringr_1.2.0.tar.gz,
evaluate_0.10.1.tar.gz,
highr_0.6.tar.gz,
markdown_0.8.tar.gz,
yaml_2.1.14.tar.gz,
reshape2_1.4.2.tar.gz,
RColorBrewer_1.1-2.tar.gz,
dichromat_2.0-0.tar.gz,
munsell_0.4.3.tar.gz,
labeling_0.3.tar.gz,
scales_0.4.1.tar.gz,
lazyeval_0.2.0.tar.gz,
dtplyr_0.0.2.tar.gz,
ggplot2_2.2.1.tar.gz,
prettyunits_1.0.2.tar.gz,
progress_1.1.2.tar.gz,
reshape_0.8.6.tar.gz,
GGally_1.3.1.tar.gz,
glmnet_2.0-10.tar.gz,
gtx_0.0.8.tar.gz,
infotheo_1.2.0.tar.gz,
inline_0.3.14.tar.gz,
knitr_1.16.tar.gz,
lattice_0.20-35.tar.gz,
leaps_3.0.tar.gz,
LearnBayes_2.15.tar.gz,
zoo_1.8-0.tar.gz,\
xts_0.10-0.tar.gz,
TTR_0.23-2.tar.gz,
quadprog_1.5-5.tar.gz,
quantmod_0.4-10.tar.gz,
tseries_0.10-42.tar.gz,
fracdiff_1.4-2.tar.gz,
lmtest_0.9-35.tar.gz,
timeDate_3012.100.tar.gz,
RcppArmadillo_0.7.900.2.0.tar.gz,
forecast_8.1.tar.gz,
logging_0.7-103.tar.gz,
sp_1.2-5.tar.gz,
maps_3.2.0.tar.gz,
mapproj_1.2-5.tar.gz,
maptools_0.9-2.tar.gz,
MASS_7.3-47.tar.gz,
mda_0.4-9.tar.gz,
meta_4.8-2.tar.gz,
metap_0.8.tar.gz,
mice_2.30.tar.gz,
mlbench_2.1-1.tar.gz,
backports_1.1.0.tar.gz,
checkmate_1.8.3.tar.gz,
BBmisc_1.11.tar.gz,
ParamHelpers_1.10.tar.gz,
parallelMap_1.3.tar.gz,
mlr_2.11.tar.gz,
abind_1.4-5.tar.gz,
magic_1.5-6.tar.gz,
netmeta_0.9-5.tar.gz,
nlme_3.1-131.tar.gz,
nnet_7.3-12.tar.gz,
pbdZMQ_0.2-6.tar.gz,
pls_2.6-0.tar.gz,
png_0.1-7.tar.gz,
pROC_1.10.0.tar.gz,
repr_0.12.0.tar.gz,
IRdisplay_0.4.4.tar.gz,
rmeta_2.16.tar.gz,
DEoptimR_1.0-8.tar.gz,
robustbase_0.92-7.tar.gz,
RODBC_1.3-15.tar.gz,
RODBCext_0.3.0.tar.gz,
mvtnorm_1.0-6.tar.gz,
pcaPP_1.9-72.tar.gz,
rrcov_1.4-3.tar.gz,
BMA_3.18.7.tar.gz,
coloc_2.3-1.tar.gz,
sets_1.0-17.tar.gz,
randomForest_4.6-12.tar.gz,
randomForestSRC_2.4.2.tar.gz,
RcppEigen_0.3.3.3.0.tar.gz,
minqa_1.2.4.tar.gz,
nloptr_1.0.4.tar.gz,
lme4_1.1-13.tar.gz,
ranger_0.8.0.tar.gz,
XML_3.98-1.9.tar.gz,
reutils_0.2.3.tar.gz,
coda_0.19-1.tar.gz,
rjags_4-6.tar.gz,
codetools_0.2-15.tar.gz,
sandwich_2.3-4.tar.gz,
TH.data_1.0-8.tar.gz,
multcomp_1.4-6.tar.gz,
estimability_1.2.tar.gz,
Matrix_1.2-10.tar.gz,
MatrixModels_0.4-1.tar.gz,
SparseM_1.77.tar.gz,
quantreg_5.33.tar.gz,
pbkrtest_0.4-7.tar.gz,
car_2.1-5.tar.gz,
ModelMetrics_1.1.0.tar.gz,
caret_6.0-76.tar.gz,
pbapply_1.3-3.tar.gz,
gridExtra_2.2.1.tar.gz,
caretEnsemble_2.0.0.tar.gz,
mcmc_0.9-5.tar.gz,
MCMCpack_1.4-0.tar.gz,
runjags_2.0.4-2.tar.gz,
R2WinBUGS_2.1-21.tar.gz,
R2jags_0.5-7.tar.gz,
rpart_4.1-11.tar.gz,
gplots_3.0.1.tar.gz,
KernSmooth_2.23-15.tar.gz,
ROCR_1.0-7.tar.gz,
rJava_0.9-8.tar.gz,
DBI_0.7.tar.gz,
RJDBC_0.2-5.tar.gz,
RWekajars_3.9.1-3.tar.gz,
RWeka_0.4-34.tar.gz,
FSelector_0.21.tar.gz,
rzmq_0.9.2.tar.gz,
scatterplot3d_0.3-40.tar.gz,
superpc_1.09.tar.gz,
survival_2.41-3.tar.gz,
Formula_1.2-2.tar.gz,
partykit_1.1-1.tar.gz,
C50_0.1.0-24.tar.gz,
gbm_2.1.3.tar.gz,
season_0.3-5.tar.gz,
tidyr_0.6.3.tar.gz,
mnormt_1.5-5.tar.gz,
psych_1.7.5.tar.gz,
broom_0.4.2.tar.gz,
hms_0.3.tar.gz,
lubridate_1.6.0.tar.gz,
xml2_1.1.1.tar.gz,
purrr_0.2.2.2.tar.gz,
modelr_0.1.0.tar.gz,
readr_1.1.1.tar.gz,
haven_1.1.0.tar.gz,
rematch_1.0.1.tar.gz,
cellranger_1.1.0.tar.gz,
readxl_1.0.0.tar.gz,
selectr_0.3-1.tar.gz,
rvest_0.3.2.tar.gz,\
tidyverse_1.1.1.tar.gz,
pastecs_1.3-18.tar.gz,
NbClust_3.0.tar.gz,
GPArotation_2014.11-1.tar.gz,
traj_1.2.tar.gz,
gridBase_0.4-7.tar.gz,
irlba_2.2.1.tar.gz,
igraph_1.1.2.tar.gz,
mRMRe_2.0.5.tar.gz,
htmltools_0.3.6.tar.gz,
htmlwidgets_0.9.tar.gz,
networkD3_0.4.tar.gz,
httpuv_1.3.5.tar.gz,
xtable_1.8-2.tar.gz,
lsmeans_2.26-3.tar.gz,
HARtools_0.0.5.tar.gz,
sourcetools_0.1.6.tar.gz,
shiny_1.0.3.tar.gz,
rgl_0.98.1.tar.gz,
miniUI_0.1.1.tar.gz,
shinyjs_0.9.1.tar.gz,
colourpicker_0.3.tar.gz,
ggExtra_0.7.tar.gz,
treemap_2.4-2.tar.gz,
truncnorm_1.0-7.tar.gz,
uuid_0.1-2.tar.gz,
vcd_1.4-3.tar.gz,
xlsxjars_0.6.1.tar.gz,
xlsx_0.5.7.tar.gz"""

import subprocess
import shlex
import pandas as pd

package_list = packages.split("\n")
package_strings = [[x[:x.rfind("_")], x[x.rfind("_") + 1:x.rfind(".tar")]] for x in package_list]
versions = {"name":["r-" + x[0].lower() for x in package_strings], "version":[x[1] for x in package_strings], "available":[]}

def search_packages():
    for x, y in zip(versions["name"], versions["version"]):
        search_string = "conda search --platform linux-64 {}={}=r3.3.2_* --spec -c defaults -c r".format(x, y)
        is_available = process_call(search_string)
        if is_available == 1:
            versions["available"].append(False)
        else:
            versions["available"].append(True)


def process_call(search_string):
    return subprocess.call(shlex.split(search_string))


search_packages()

df = pd.DataFrame(versions)
writer = pd.ExcelWriter("r_packages.xlsx")
df.to_excel(writer)
writer.save()